import{r,a as k}from"./index-8db94870.js";import{$ as U,d as y,c as h}from"./index-83c8a788.js";import{_ as x}from"./extends-98964cd2.js";import{$ as C,a as z}from"./index-37144071.js";import{a as A}from"./index-ba8d3fc7.js";import{R as K}from"./index-8ce4a492.js";const N=k["useId".toString()]||(()=>{});let H=0;function ne(n){const[e,s]=r.useState(N());return U(()=>{n||s(t=>t??String(H++))},[n]),n||(e?`radix-${e}`:"")}function M(n,e=globalThis==null?void 0:globalThis.document){const s=y(n);r.useEffect(()=>{const t=o=>{o.key==="Escape"&&s(o)};return e.addEventListener("keydown",t),()=>e.removeEventListener("keydown",t)},[s,e])}const p="dismissableLayer.update",X="dismissableLayer.pointerDownOutside",j="dismissableLayer.focusOutside";let T;const q=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),se=r.forwardRef((n,e)=>{var s;const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:b,onInteractOutside:l,onDismiss:u,...v}=n,a=r.useContext(q),[d,R]=r.useState(null),f=(s=d==null?void 0:d.ownerDocument)!==null&&s!==void 0?s:globalThis==null?void 0:globalThis.document,[,F]=r.useState({}),S=A(e,i=>R(i)),m=Array.from(a.layers),[I]=[...a.layersWithOutsidePointerEventsDisabled].slice(-1),W=m.indexOf(I),O=d?m.indexOf(d):-1,_=a.layersWithOutsidePointerEventsDisabled.size>0,D=O>=W,B=G(i=>{const $=i.target,P=[...a.branches].some(E=>E.contains($));!D||P||(c==null||c(i),l==null||l(i),i.defaultPrevented||u==null||u())},f),g=J(i=>{const $=i.target;[...a.branches].some(E=>E.contains($))||(b==null||b(i),l==null||l(i),i.defaultPrevented||u==null||u())},f);return M(i=>{O===a.layers.size-1&&(o==null||o(i),!i.defaultPrevented&&u&&(i.preventDefault(),u()))},f),r.useEffect(()=>{if(d)return t&&(a.layersWithOutsidePointerEventsDisabled.size===0&&(T=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),a.layersWithOutsidePointerEventsDisabled.add(d)),a.layers.add(d),w(),()=>{t&&a.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=T)}},[d,f,t,a]),r.useEffect(()=>()=>{d&&(a.layers.delete(d),a.layersWithOutsidePointerEventsDisabled.delete(d),w())},[d,a]),r.useEffect(()=>{const i=()=>F({});return document.addEventListener(p,i),()=>document.removeEventListener(p,i)},[]),r.createElement(C.div,x({},v,{ref:S,style:{pointerEvents:_?D?"auto":"none":void 0,...n.style},onFocusCapture:h(n.onFocusCapture,g.onFocusCapture),onBlurCapture:h(n.onBlurCapture,g.onBlurCapture),onPointerDownCapture:h(n.onPointerDownCapture,B.onPointerDownCapture)}))});function G(n,e=globalThis==null?void 0:globalThis.document){const s=y(n),t=r.useRef(!1),o=r.useRef(()=>{});return r.useEffect(()=>{const c=l=>{if(l.target&&!t.current){let v=function(){L(X,s,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=v,e.addEventListener("click",o.current,{once:!0})):v()}t.current=!1},b=window.setTimeout(()=>{e.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(b),e.removeEventListener("pointerdown",c),e.removeEventListener("click",o.current)}},[e,s]),{onPointerDownCapture:()=>t.current=!0}}function J(n,e=globalThis==null?void 0:globalThis.document){const s=y(n),t=r.useRef(!1);return r.useEffect(()=>{const o=c=>{c.target&&!t.current&&L(j,s,{originalEvent:c},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,s]),{onFocusCapture:()=>t.current=!0,onBlurCapture:()=>t.current=!1}}function w(){const n=new CustomEvent(p);document.dispatchEvent(n)}function L(n,e,s,{discrete:t}){const o=s.originalEvent.target,c=new CustomEvent(n,{bubbles:!1,cancelable:!0,detail:s});e&&o.addEventListener(n,e,{once:!0}),t?z(o,c):o.dispatchEvent(c)}const oe=r.forwardRef((n,e)=>{var s;const{container:t=globalThis==null||(s=globalThis.document)===null||s===void 0?void 0:s.body,...o}=n;return t?K.createPortal(r.createElement(C.div,x({},o,{ref:e})),t):null});export{ne as $,oe as a,se as b};
//# sourceMappingURL=index-e9ff3c0e.js.map
